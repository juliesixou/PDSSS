group_by(NOM_REGION) %>%
#top_n(200,ratio) %>%
arrange(ratio,.by_group=TRUE) %>%
filter(NOM_REGION=="BRETAGNE")
prenoms_surrep_bretagne
#write.csv(prenoms_surrep_bretagne,"prenoms_surrep_bretagne.csv")
#Rajout de la fréquence nationale
tb_props <- tb_props %>% left_join(tb_freq_nat,by="preusuel")
#Tableau précédent avec le filtre : "prénom donné au moins 4 fois"
prenoms_surrep_4 <- tb_props %>%
filter(freq_nat>=4) %>%
group_by(NOM_REGION) %>%
top_n(10,ratio) %>%
arrange(ratio,.by_group=TRUE)
prenoms_surrep_4
#Tableau précédent avec le filtre : "prénom donné au moins 10 fois"
prenoms_surrep_10 <- tb_props %>%
filter(freq_nat>=10) %>%
group_by(NOM_REGION) %>%
top_n(10,ratio) %>%
arrange(ratio,.by_group=TRUE)
prenoms_surrep_10
listb %>% rename(preusuel=prenom) %>%
left_join(tb_props,by='preusuel') %>%
filter(!(NOM_REGION %in% c("GUADELOUPE","MARTINIQUE","GUYANE","LA REUNION"))) %>%
group_by(preusuel) %>%
mutate(max_surrep=max(ratio)) %>%
filter(ratio==max_surrep)
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/julie/Documents/ENSAE/S1/PDSSS")
library(dplyr)
library(stringr)
library(dplyr)
library(RColorBrewer)
library(sp)
library(rgdal)
library(readxl)
library("rgdal")
library("rgeos")
library("maptools")
library("ggplot2")
library("mapproj")
library("ggthemes")
prenoms <- read.csv("dpt2020.csv",sep=";",encoding = "UTF-8")
cor_dep_reg_2015 <- read.csv("cor_dep_reg_2015.csv",sep=";")
cor_dep_reg_2015 <- cor_dep_reg_2015 %>% select(-REGION)
cor_dep_reg_2015 <- cor_dep_reg_2015 %>%  mutate(DEP=ifelse(DEP %in% c('2A','2B'),'20',DEP)) %>%
distinct()
listb <- read_excel("sixou-boul-dsss/sixou-boul-dsss/prenoms_bretons.xlsx")%>%
distinct(.keep_all = TRUE) %>%
mutate(prenom=str_to_upper(prenom))
pren_68 <- prenoms %>% filter(annais<=1968)
pren_68$DEP <- str_replace(pren_68$dpt, "^0+" ,"")
pren_68 <- pren_68 %>% left_join(cor_dep_reg_2015,by="DEP")
#Naissances par région
nais_reg <- pren_68 %>% group_by(NOM_REGION) %>%
summarise(nb_naissances=sum(nombre))
#Naissances totales
nais_nat <- sum(nais_reg$nb_naissances)
#Fréquence nationale
tb_freq_nat <- pren_68 %>% group_by(preusuel) %>%
summarise(freq_nat=sum(nombre))
quantile(tb_freq_nat$freq_nat) #75% des prénoms sont donnés au moins 4 fois en 1968. 50% des prénoms sont donnés au moins 13 fois.
#Proportion nationale
tb_prop_nat <- pren_68 %>% group_by(preusuel) %>%
summarise(prop_nat=sum(nombre)/nais_nat)
#Fréquence régionale
tb_freq_reg <- pren_68 %>% group_by(preusuel,NOM_REGION) %>%
summarise(freq_reg=sum(nombre))
tb_freq_reg <- tb_freq_reg %>% left_join(nais_reg,by="NOM_REGION")
tb_prop_reg <- tb_freq_reg %>% mutate(prop_reg=freq_reg/nb_naissances) %>%
select(prop_reg,NOM_REGION,preusuel) #prop_reg : proportion de preusuel dans NOM_REGION en 1968
#Table de proportions nationale et régionale
tb_props <- tb_prop_nat %>% left_join(tb_prop_reg,by="preusuel")
#Comparaison des proportions
tb_props <- tb_props %>% mutate(ratio=prop_reg/prop_nat)
prenoms_surrep_total <- tb_props %>%
group_by(NOM_REGION) %>%
top_n(10,ratio) %>%
arrange(ratio,.by_group=TRUE)
prenoms_surrep_total
prenoms_surrep_bretagne <- tb_props %>%
group_by(NOM_REGION) %>%
#top_n(200,ratio) %>%
arrange(ratio,.by_group=TRUE) %>%
filter(NOM_REGION=="BRETAGNE")
prenoms_surrep_bretagne
#write.csv(prenoms_surrep_bretagne,"prenoms_surrep_bretagne.csv")
#Rajout de la fréquence nationale
tb_props <- tb_props %>% left_join(tb_freq_nat,by="preusuel")
#Tableau précédent avec le filtre : "prénom donné au moins 4 fois"
prenoms_surrep_4 <- tb_props %>%
filter(freq_nat>=4) %>%
group_by(NOM_REGION) %>%
top_n(10,ratio) %>%
arrange(ratio,.by_group=TRUE)
prenoms_surrep_4
#Tableau précédent avec le filtre : "prénom donné au moins 10 fois"
prenoms_surrep_10 <- tb_props %>%
filter(freq_nat>=10) %>%
group_by(NOM_REGION) %>%
top_n(10,ratio) %>%
arrange(ratio,.by_group=TRUE)
prenoms_surrep_10
listb %>% rename(preusuel=prenom) %>%
left_join(tb_props,by='preusuel') %>%
filter(!(NOM_REGION %in% c("GUADELOUPE","MARTINIQUE","GUYANE","LA REUNION"))) %>%
group_by(preusuel) %>%
mutate(max_surrep=max(ratio)) %>%
filter(ratio==max_surrep)
knitr::opts_chunk$set(cache=TRUE,
message=FALSE, warning=FALSE,
fig.path='figs/',
cache.path = '_cache/',
fig.process = function(x) {
x2 = sub('-\\d+([.][a-z]+)$', '\\1', x)
if (file.rename(x, x2)) x2 else x
})
---
output:
pdf_document:
citation_package: natbib
library(stevedata)
data(uniondensity)
install.packages("stevedata")
library(stevedata)
data(uniondensity)
library(tidyverse)
uniondensity %>%
mutate(z_left = r2sd(left),
z_size = r2sd(size),
z_concen = r2sd(concen)) -> uniondensity
?r2sd
library(stevedata)
data(uniondensity)
library(tidyverse)
uniondensity %>%
mutate(z_left = r2sd(left),
z_size = r2sd(size),
z_concen = r2sd(concen)) -> uniondensity
library(stevedata)
data(uniondensity)
library(stargazer)
M1 <- lm(union ~ left + size + concen, data=uniondensity)
stargazer(M1, title="A Handsome Table", header=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(tidyverse)
library("writexl")
library(foreign)
library(DAAG)
library(ivreg)
library(tidyr)
library(plm)
library(lfe)
library(stargazer)
library(effects)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(tidyverse)
library("writexl")
library(foreign)
listb <- read_excel("prenoms_bretons.xlsx")%>%
distinct(.keep_all = TRUE) %>%
mutate(prenom=str_to_upper(prenom))
View(listb)
prenoms <- read.csv("C:/Users/julie/Documents/ENSAE/S1/PDSSS/dpt2020.csv",sep=";",encoding = "UTF-8") %>%
#filter(annais %in% c(1968, 1975, 1982, 1990, 1999, 2006)) %>%
mutate(annais=as.numeric(annais)) %>%
mutate(nombre=as.numeric(nombre)) %>%
mutate(breton=ifelse(preusuel %in% listb$prenom,1,0))
prenoms_bretons_donnes <- prenoms %>% filter(breton==1) %>% distinct(preusuel)
View(prenoms_bretons_donnes)
View(prenoms)
knitr::opts_chunk$set(echo = TRUE)
surrep_listb <- listb %>% rename(preusuel=prenom) %>%
left_join(tb_props,by='preusuel') %>%
filter(!(NOM_REGION %in% c("GUADELOUPE","MARTINIQUE","GUYANE","LA REUNION"))) %>%
group_by(preusuel) %>%
mutate(max_surrep=max(ratio)) %>%
filter(ratio==max_surrep)
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/julie/Documents/ENSAE/S1/PDSSS")
library(dplyr)
library(stringr)
library(dplyr)
library(RColorBrewer)
library(sp)
library(rgdal)
library(readxl)
library("rgdal")
library("rgeos")
library("maptools")
library("ggplot2")
library("mapproj")
library("ggthemes")
prenoms <- read.csv("dpt2020.csv",sep=";",encoding = "UTF-8")
cor_dep_reg_2015 <- read.csv("cor_dep_reg_2015.csv",sep=";")
cor_dep_reg_2015 <- cor_dep_reg_2015 %>% select(-REGION)
cor_dep_reg_2015 <- cor_dep_reg_2015 %>%  mutate(DEP=ifelse(DEP %in% c('2A','2B'),'20',DEP)) %>%
distinct()
listb <- read_excel("sixou-boul-dsss/sixou-boul-dsss/prenoms_bretons.xlsx")%>%
distinct(.keep_all = TRUE) %>%
mutate(prenom=str_to_upper(prenom))
pren_68 <- prenoms %>% filter(annais<=1968)
pren_68$DEP <- str_replace(pren_68$dpt, "^0+" ,"")
pren_68 <- pren_68 %>% left_join(cor_dep_reg_2015,by="DEP")
#Naissances par région
nais_reg <- pren_68 %>% group_by(NOM_REGION) %>%
summarise(nb_naissances=sum(nombre))
#Naissances totales
nais_nat <- sum(nais_reg$nb_naissances)
#Fréquence nationale
tb_freq_nat <- pren_68 %>% group_by(preusuel) %>%
summarise(freq_nat=sum(nombre))
quantile(tb_freq_nat$freq_nat) #75% des prénoms sont donnés au moins 4 fois en 1968. 50% des prénoms sont donnés au moins 13 fois.
#Proportion nationale
tb_prop_nat <- pren_68 %>% group_by(preusuel) %>%
summarise(prop_nat=sum(nombre)/nais_nat)
#Fréquence régionale
tb_freq_reg <- pren_68 %>% group_by(preusuel,NOM_REGION) %>%
summarise(freq_reg=sum(nombre))
tb_freq_reg <- tb_freq_reg %>% left_join(nais_reg,by="NOM_REGION")
tb_prop_reg <- tb_freq_reg %>% mutate(prop_reg=freq_reg/nb_naissances) %>%
select(prop_reg,NOM_REGION,preusuel) #prop_reg : proportion de preusuel dans NOM_REGION en 1968
#Table de proportions nationale et régionale
tb_props <- tb_prop_nat %>% left_join(tb_prop_reg,by="preusuel")
#Comparaison des proportions
tb_props <- tb_props %>% mutate(ratio=prop_reg/prop_nat)
prenoms_surrep_total <- tb_props %>%
group_by(NOM_REGION) %>%
top_n(10,ratio) %>%
arrange(ratio,.by_group=TRUE)
prenoms_surrep_total
prenoms_surrep_bretagne <- tb_props %>%
group_by(NOM_REGION) %>%
#top_n(200,ratio) %>%
arrange(ratio,.by_group=TRUE) %>%
filter(NOM_REGION=="BRETAGNE")
prenoms_surrep_bretagne
#write.csv(prenoms_surrep_bretagne,"prenoms_surrep_bretagne.csv")
#Rajout de la fréquence nationale
tb_props <- tb_props %>% left_join(tb_freq_nat,by="preusuel")
#Tableau précédent avec le filtre : "prénom donné au moins 4 fois"
prenoms_surrep_4 <- tb_props %>%
filter(freq_nat>=4) %>%
group_by(NOM_REGION) %>%
top_n(10,ratio) %>%
arrange(ratio,.by_group=TRUE)
prenoms_surrep_4
#Tableau précédent avec le filtre : "prénom donné au moins 10 fois"
prenoms_surrep_10 <- tb_props %>%
filter(freq_nat>=10) %>%
group_by(NOM_REGION) %>%
top_n(10,ratio) %>%
arrange(ratio,.by_group=TRUE)
prenoms_surrep_10
surrep_listb <- listb %>% rename(preusuel=prenom) %>%
left_join(tb_props,by='preusuel') %>%
filter(!(NOM_REGION %in% c("GUADELOUPE","MARTINIQUE","GUYANE","LA REUNION"))) %>%
group_by(preusuel) %>%
mutate(max_surrep=max(ratio)) %>%
filter(ratio==max_surrep)
surrep_listb
prenoms_bretons_donnes %>% left_join(surrep_listb,by="preusuel")
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/julie/Documents/ENSAE/S1/PDSSS")
library(dplyr)
library(stringr)
library(dplyr)
library(RColorBrewer)
library(sp)
library(rgdal)
library(readxl)
library("rgdal")
library("rgeos")
library("maptools")
library("ggplot2")
library("mapproj")
library("ggthemes")
prenoms <- read.csv("dpt2020.csv",sep=";",encoding = "UTF-8")
cor_dep_reg_2015 <- read.csv("cor_dep_reg_2015.csv",sep=";")
cor_dep_reg_2015 <- cor_dep_reg_2015 %>% select(-REGION)
cor_dep_reg_2015 <- cor_dep_reg_2015 %>%  mutate(DEP=ifelse(DEP %in% c('2A','2B'),'20',DEP)) %>%
distinct()
listb <- read_excel("sixou-boul-dsss/sixou-boul-dsss/prenoms_bretons.xlsx")%>%
distinct(.keep_all = TRUE) %>%
mutate(prenom=str_to_upper(prenom))
pren_68 <- prenoms %>% filter(annais==1968)
pren_68$DEP <- str_replace(pren_68$dpt, "^0+" ,"")
pren_68 <- pren_68 %>% left_join(cor_dep_reg_2015,by="DEP")
#Naissances par région
nais_reg <- pren_68 %>% group_by(NOM_REGION) %>%
summarise(nb_naissances=sum(nombre))
#Naissances totales
nais_nat <- sum(nais_reg$nb_naissances)
#Fréquence nationale
tb_freq_nat <- pren_68 %>% group_by(preusuel) %>%
summarise(freq_nat=sum(nombre))
quantile(tb_freq_nat$freq_nat) #75% des prénoms sont donnés au moins 4 fois en 1968. 50% des prénoms sont donnés au moins 13 fois.
#Proportion nationale
tb_prop_nat <- pren_68 %>% group_by(preusuel) %>%
summarise(prop_nat=sum(nombre)/nais_nat)
#Fréquence régionale
tb_freq_reg <- pren_68 %>% group_by(preusuel,NOM_REGION) %>%
summarise(freq_reg=sum(nombre))
tb_freq_reg <- tb_freq_reg %>% left_join(nais_reg,by="NOM_REGION")
tb_prop_reg <- tb_freq_reg %>% mutate(prop_reg=freq_reg/nb_naissances) %>%
select(prop_reg,NOM_REGION,preusuel) #prop_reg : proportion de preusuel dans NOM_REGION en 1968
#Table de proportions nationale et régionale
tb_props <- tb_prop_nat %>% left_join(tb_prop_reg,by="preusuel")
#Comparaison des proportions
tb_props <- tb_props %>% mutate(ratio=prop_reg/prop_nat)
prenoms_surrep_total <- tb_props %>%
group_by(NOM_REGION) %>%
top_n(10,ratio) %>%
arrange(ratio,.by_group=TRUE)
prenoms_surrep_total
prenoms_surrep_bretagne <- tb_props %>%
group_by(NOM_REGION) %>%
#top_n(200,ratio) %>%
arrange(ratio,.by_group=TRUE) %>%
filter(NOM_REGION=="BRETAGNE")
prenoms_surrep_bretagne
#write.csv(prenoms_surrep_bretagne,"prenoms_surrep_bretagne.csv")
#Rajout de la fréquence nationale
tb_props <- tb_props %>% left_join(tb_freq_nat,by="preusuel")
#Tableau précédent avec le filtre : "prénom donné au moins 4 fois"
prenoms_surrep_4 <- tb_props %>%
filter(freq_nat>=4) %>%
group_by(NOM_REGION) %>%
top_n(10,ratio) %>%
arrange(ratio,.by_group=TRUE)
prenoms_surrep_4
#Tableau précédent avec le filtre : "prénom donné au moins 10 fois"
prenoms_surrep_10 <- tb_props %>%
filter(freq_nat>=10) %>%
group_by(NOM_REGION) %>%
top_n(10,ratio) %>%
arrange(ratio,.by_group=TRUE)
prenoms_surrep_10
surrep_listb <- listb %>% rename(preusuel=prenom) %>%
left_join(tb_props,by='preusuel') %>%
filter(!(NOM_REGION %in% c("GUADELOUPE","MARTINIQUE","GUYANE","LA REUNION"))) %>%
group_by(preusuel) %>%
mutate(max_surrep=max(ratio)) %>%
filter(ratio==max_surrep)
prenoms_bretons_donnes %>% left_join(surrep_listb,by="preusuel")
bretons_surrep <- prenoms_bretons_donnes %>% left_join(surrep_listb,by="preusuel")
sum(is.na(bretons_surrep$prop_nat))
mean(bretons_surrep$max_surrep)
bretons_surrep
mean(bretons_surrep$max_surrep,is.na=FALSE)
mean(bretons_surrep$max_surrep,na.rm=TRUE)
mean(subset(bretons_surrep,NOM_REGION=="BRETAGNE")$max_surrep,na.rm=TRUE)
mean(subset(bretons_surrep,NOM_REGION!="BRETAGNE")$max_surrep,na.rm=TRUE)
sum(bretons_surrep$NOM_REGION!="BRETAGNE")
sum(is.na(bretons_surrep$prop_nat))
sum(bretons_surrep$NOM_REGION=="BRETAGNE")
sum(bretons_surrep$NOM_REGION!="BRETAGNE")
sum(bretons_surrep$NOM_REGION!="BRETAGNE",na.rm=TRUE)
sum(is.na(bretons_surrep$prop_nat))
sum(bretons_surrep$NOM_REGION=="BRETAGNE",na.rm=TRUE)
sum(bretons_surrep$NOM_REGION!="BRETAGNE",na.rm=TRUE)
table(bretons_surrep$NOM_REGION)
sum(is.na(bretons_surrep$prop_nat))
30/(371-312)
max(bretons_surrep$max_surrep)
max(bretons_surrep$max_surrep,na.rm=TRUE)
bretons_surrep %>% filter(max_surrep==max(max_surrep,na.rm=TRUE))
bretons_surrep %>% top_n(max_surrep,10)
?top_n
bretons_surrep %>% slice_max(max_surrep,10)
bretons_surrep %>% slice_max(prop,10)
bretons_surrep %>% slice_max(prop_nat,10)
library(spdep)
library(dplyr)
library(readxl)
library(igraph)
library(reshape2)
contiguite <- read_xlsx("contiguous_cols.xlsx") %>%
filter(dpt!="20")
contiguite_nobret <- read_xlsx("contiguous_cols_nobret.xlsx") %>%
filter(dpt!="20")
bretons <- read_xlsx("prop_bretons_annee_dep.xlsx") %>%
mutate(dep_res=as.numeric(dep_res)) %>%
filter(dep_res <= 95) %>%
filter(!(is.na(dep_res)))
colnames(bretons) <- c("dpt","p68","p75","82","p90","p99","p06")
prenoms_bretons_68 <- read_xlsx("base68.xlsx") %>%
select(dpt,freq) %>%
rename(prenbret=freq) %>%
filter(dpt<=95) %>%
filter(dpt!=20)
prenoms_bretons_06 <- read_xlsx("base06.xlsx") %>%
select(dpt,freq) %>%
rename(prenbret=freq) %>%
filter(dpt<=95) %>%
filter(dpt!=20)
df_voisins <- melt(contiguite,id.vars = "dpt") %>%
filter(!(is.na(value))) %>%
select(-variable) %>%
filter(value!=20,dpt!=20)
adja <- get.adjacency(graph.edgelist(as.matrix(df_voisins), directed=FALSE))
adja <- as.matrix(adja)
adja <- adja[-20,-20]
adja <- adja/2
rownames(adja) <- prenoms_bretons_68$dpt
my_listw <- mat2listw(adja,  style="M")
moran.plot(prenoms_bretons_06$prenbret,my_listw)
moran.test(prenoms_bretons_06$prenbret,my_listw)
?moran.plot
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins")
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les\n départements voisins")
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins")
localmoran(prenoms_bretons_68$prenbret,my_listw)
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les\n départements voisins")
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins")
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="opnsc")
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran pour la part de prénoms bretons (France métropolitaine hors Corse)")
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran pour la part de prénoms bretons \n (France métropolitaine hors Corse)")
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (France métropolitaine hors Corse)")
moran.test(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (2006, France métropolitaine hors Corse)")
moran.test(prenoms_bretons_06$prenbret,my_listw)
?moran.test
moran.plot(prenbret68_nobret$prenbret,my_listw_nobret)
library(spdep)
library(dplyr)
library(readxl)
library(igraph)
library(reshape2)
contiguite <- read_xlsx("contiguous_cols.xlsx") %>%
filter(dpt!="20")
contiguite_nobret <- read_xlsx("contiguous_cols_nobret.xlsx") %>%
filter(dpt!="20")
bretons <- read_xlsx("prop_bretons_annee_dep.xlsx") %>%
mutate(dep_res=as.numeric(dep_res)) %>%
filter(dep_res <= 95) %>%
filter(!(is.na(dep_res)))
colnames(bretons) <- c("dpt","p68","p75","82","p90","p99","p06")
prenoms_bretons_68 <- read_xlsx("base68.xlsx") %>%
select(dpt,freq) %>%
rename(prenbret=freq) %>%
filter(dpt<=95) %>%
filter(dpt!=20)
prenoms_bretons_06 <- read_xlsx("base06.xlsx") %>%
select(dpt,freq) %>%
rename(prenbret=freq) %>%
filter(dpt<=95) %>%
filter(dpt!=20)
df_voisins <- melt(contiguite,id.vars = "dpt") %>%
filter(!(is.na(value))) %>%
select(-variable) %>%
filter(value!=20,dpt!=20)
adja <- get.adjacency(graph.edgelist(as.matrix(df_voisins), directed=FALSE))
adja <- as.matrix(adja)
adja <- adja[-20,-20]
adja <- adja/2
rownames(adja) <- prenoms_bretons_68$dpt
my_listw <- mat2listw(adja,  style="M")
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (1968, France métropolitaine hors Corse)")
moran.test(prenoms_bretons_06$prenbret,my_listw)
localmoran(prenoms_bretons_68$prenbret,my_listw)
localmoran(prenoms_bretons_06$prenbret,my_listw)
prenbret68_nobret <- prenoms_bretons_68 %>% filter(!(dpt %in% c(22,29,35,56)))
prenbret06_nobret <- prenoms_bretons_06 %>% filter(!(dpt %in% c(22,29,35,56)))
df_voisins_nobret <- melt(contiguite_nobret,id.vars = "dpt") %>%
filter(!(is.na(value))) %>%
select(-variable) %>%
filter(value!=20,dpt!=20)
adja_nobret <- get.adjacency(graph.edgelist(as.matrix(df_voisins_nobret), directed=FALSE))
adja_nobret <- as.matrix(adja_nobret)
adja_nobret <- adja_nobret[-c(20,22,29,35,56),-c(20,22,29,35,56)]
adja_nobret <- adja_nobret/2
rownames(adja_nobret) <- prenbret68_nobret$dpt
my_listw_nobret <- mat2listw(adja_nobret,  style="M")
moran.plot(prenbret68_nobret$prenbret,my_listw_nobret)
moran.test(prenbret68_nobret$prenbret,my_listw_nobret)
localmoran(prenoms_bretons_68$prenbret,my_listw)
prenbret68_nobret <- prenoms_bretons_68 %>% filter(!(dpt %in% c(22,29,35,56)))
prenbret06_nobret <- prenoms_bretons_06 %>% filter(!(dpt %in% c(22,29,35,56)))
prenbret68_nobret <- prenoms_bretons_68 %>% filter(!(dpt %in% c(22,29,35,56)))
prenbret06_nobret <- prenoms_bretons_06 %>% filter(!(dpt %in% c(22,29,35,56)))
df_voisins_nobret <- melt(contiguite_nobret,id.vars = "dpt") %>%
filter(!(is.na(value))) %>%
select(-variable) %>%
filter(value!=20,dpt!=20)
adja_nobret <- get.adjacency(graph.edgelist(as.matrix(df_voisins_nobret), directed=FALSE))
adja_nobret <- as.matrix(adja_nobret)
adja_nobret <- adja_nobret[-c(20,22,29,35,56),-c(20,22,29,35,56)]
adja_nobret <- adja_nobret/2
rownames(adja_nobret) <- prenbret68_nobret$dpt
my_listw_nobret <- mat2listw(adja_nobret,  style="M")
moran.plot(prenbret68_nobret$prenbret,my_listw_nobret)
moran.test(prenbret68_nobret$prenbret,my_listw_nobret)
moran.plot(prenbret06_nobret$prenbret,my_listw_nobret)
moran.test(prenbret06_nobret$prenbret,my_listw_nobret)
moran.test(prenbret06_nobret$prenbret,my_listw_nobret,alternative="less")
moran.test(prenbret06_nobret$prenbret,my_listw_nobret,alternative="greater")
moran.plot(prenoms_bretons_68$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (1968, France métropolitaine hors Corse)")
moran.test(prenoms_bretons_68$prenbret,my_listw)
moran.plot(prenoms_bretons_68$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (1968, France métropolitaine hors Corse)")
moran.plot(prenbret68_nobret$prenbret,my_listw_nobret,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (1968, France métropolitaine hors Corse et hors Bretagne)")
moran.test(prenbret68_nobret$prenbret,my_listw_nobret)
moran.plot(prenbret68_nobret$prenbret,my_listw_nobret,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (1968, France métropolitaine hors Corse et hors Bretagne)")
moran.test(prenbret68_nobret$prenbret,my_listw_nobret)
moran.plot(prenbret68_nobret$prenbret,my_listw_nobret,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (1968, France métropolitaine hors Corse et hors Bretagne)")
moran.plot(prenbret68_nobret$prenbret,my_listw_nobret,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (1968, France métropolitaine hors Corse et hors Bretagne)")
moran.plot(prenbret06_nobret$prenbret,my_listw_nobret,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (2006, France métropolitaine hors Corse et hors Bretagne)")
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (2006, France métropolitaine hors Corse)")
