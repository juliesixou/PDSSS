mutate(cad_cont=cad_cont/nb_vois)%>%
mutate(pi_cont=pi_cont/nb_vois)%>%
mutate(emp_cont=emp_cont/nb_vois)%>%
mutate(ouv_cont=ouv_cont/nb_vois)%>%
mutate(anc_cont=anc_cont/nb_vois)%>%
mutate(ina_cont=ina_cont/nb_vois)
base06 <- base06 %>%
mutate(dpt=as.numeric(dpt)) %>%
left_join(contiguous, by='dpt')
base06[,'avg_cont'] <- 0
base06[,'bret_cont'] <- 0
base06[,'age_cont'] <- 0
base06[,'agr_cont'] <- 0
base06[,'art_cont'] <- 0
base06[,'cad_cont'] <- 0
base06[,'pi_cont'] <- 0
base06[,'emp_cont'] <- 0
base06[,'ouv_cont'] <- 0
base06[,'anc_cont'] <- 0
base06[,'ina_cont'] <- 0
base06[,'nb_vois'] <- 0
for (dep in 1:95) {
base06[dep,'nb_vois'] <- length(list(as.numeric(strsplit(base06[dep,'voisins'][[1]],',')[[1]]))[[1]])
for(voi in list(as.numeric(strsplit(base06[dep,'voisins'][[1]],',')[[1]]))[[1]]) {
base06[dep, 'avg_cont'] <- base06[dep, 'avg_cont'] + base06[voi, 'freq']
base06[dep, 'bret_cont'] <- base06[dep, 'bret_cont'] + base06[voi, 'part_bret']
base06[dep, 'age_cont'] <- base06[dep, 'age_cont'] + base06[voi, 'age_moy']
base06[dep, 'agr_cont'] <- base06[dep, 'agr_cont'] + base06[voi, 'prop_agr']
base06[dep, 'art_cont'] <- base06[dep, 'art_cont'] + base06[voi, 'prop_art']
base06[dep, 'cad_cont'] <- base06[dep, 'cad_cont'] + base06[voi, 'prop_cad']
base06[dep, 'pi_cont'] <- base06[dep, 'pi_cont'] + base06[voi, 'prop_pi']
base06[dep, 'emp_cont'] <- base06[dep, 'emp_cont'] + base06[voi, 'prop_emp']
base06[dep, 'ouv_cont'] <- base06[dep, 'ouv_cont'] + base06[voi, 'prop_ouv']
base06[dep, 'anc_cont'] <- base06[dep, 'anc_cont'] + base06[voi, 'prop_anc']
base06[dep, 'ina_cont'] <- base06[dep, 'ina_cont'] + base06[voi, 'prop_ina']}
}
base06 <- base06 %>%
mutate(avg_cont=avg_cont/nb_vois) %>%
mutate(bret_cont=bret_cont/nb_vois)%>%
mutate(age_cont=age_cont/nb_vois)%>%
mutate(agr_cont=agr_cont/nb_vois)%>%
mutate(art_cont=art_cont/nb_vois)%>%
mutate(cad_cont=cad_cont/nb_vois)%>%
mutate(pi_cont=pi_cont/nb_vois)%>%
mutate(emp_cont=emp_cont/nb_vois)%>%
mutate(ouv_cont=ouv_cont/nb_vois)%>%
mutate(anc_cont=anc_cont/nb_vois)%>%
mutate(ina_cont=ina_cont/nb_vois)
base68 <- base68 %>%
mutate(reg_bret = ifelse(dpt %in% c(22,29,35,56),1,0))
base75 <- base75 %>%
mutate(reg_bret = ifelse(dpt %in% c(22,29,35,56),1,0))
base82 <- base82 %>%
mutate(reg_bret = ifelse(dpt %in% c(22,29,35,56),1,0))
base90 <- base90 %>%
mutate(reg_bret = ifelse(dpt %in% c(22,29,35,56),1,0))
base99 <- base99 %>%
mutate(reg_bret = ifelse(dpt %in% c(22,29,35,56),1,0))
base06 <- base06 %>%
mutate(reg_bret = ifelse(dpt %in% c(22,29,35,56),1,0))
densite <- read_xlsx("RP_pour_densite.xlsx") %>%
select(-c(LIBGEO,P18_POP,P13_POP))
densite <- densite %>% group_by(DEP) %>%
summarise(pop08=sum(P08_POP),pop99=sum(D99_POP),pop90=sum(D90_POP),pop82=sum(D82_POP),pop75=sum(D75_POP),pop68=sum(D68_POP),SUPERF=sum(SUPERF)) %>%
mutate(dens68=pop68/SUPERF,dens75=pop75/SUPERF,dens82=pop82/SUPERF,dens90=pop90/SUPERF,dens99=pop99/SUPERF,dens08=pop08/SUPERF) %>%
select(-starts_with('pop'))
densite <- densite %>% mutate(dpt=as.numeric(DEP))
base68 <- base68 %>% left_join(select(densite,c(dens68,dpt)),by='dpt') %>%
rename(densite=dens68)
base75 <- base75 %>% left_join(select(densite,c(dens75,dpt)),by='dpt') %>%
rename(densite=dens75)
base82 <- base82 %>% left_join(select(densite,c(dens82,dpt)),by='dpt') %>%
rename(densite=dens82)
base90 <- base90 %>% left_join(select(densite,c(dens90,dpt)),by='dpt') %>%
rename(densite=dens90)
base99 <- base99 %>% left_join(select(densite,c(dens99,dpt)),by='dpt') %>%
rename(densite=dens99)
base06 <- base06 %>% left_join(select(densite,c(dens08,dpt)),by='dpt') %>%
rename(densite=dens08)
paires <- contiguous
paires <- setNames(data.frame(matrix(ncol = 2, nrow = 4465)), c("dpt1", "dpt2")) #95(95-1)/2 = 4465
for(i in 1:95){
#print(i)
for(j in 1:95){
#print(j)
paires[(i-1)*95+j,1] <- i
paires[(i-1)*95+j,2] <- j
}
}
paires <- paires %>%
filter(dpt1!=dpt2) %>%
filter(dpt1!=20) %>%
filter(dpt2!=20) %>%
left_join(contiguous, by = c("dpt1" = "dpt")) %>%
left_join(contiguous, by = c("dpt2" = "dpt"))
paires[,'ind_voisins'] <- 0
for(i in 1:dim(paires)[1]){
if(paires[i,'dpt2'] %in% list(as.numeric(strsplit(paires[i,'voisins.x'][[1]],',')[[1]]))[[1]]){
paires[i,'ind_voisins'] <- 1}else{paires[i,'ind_voisins'] <- 0}
}
distance_bretagne <- read.csv("distance_bretagne.csv",sep=";",encoding = "UTF-8") %>%
select(c(X, dist_min))
matrice_distance_paires <- read.csv("matrice_distance_paires.csv",sep=";") %>%
pivot_longer(!X,names_to = "dpt2", values_to = "distance_géo") %>%
mutate(dpt2=sub('X', '', dpt2)) %>%
mutate(X=as.numeric(X)) %>%
mutate(dpt2=as.numeric(dpt2))
colnames(distance_bretagne)[1] <- 'dpt'
colnames(matrice_distance_paires)[1] <- 'dpt1'
paires <- paires %>%
left_join(matrice_distance_paires, by=c("dpt1", "dpt2"))
base68 <- base68 %>%
left_join(distance_bretagne, by="dpt")
base75 <- base75 %>%
left_join(distance_bretagne, by="dpt")
base82 <- base82 %>%
left_join(distance_bretagne, by="dpt")
base90 <- base90 %>%
left_join(distance_bretagne, by="dpt")
base99 <- base99 %>%
left_join(distance_bretagne, by="dpt")
base06 <- base06 %>%
left_join(distance_bretagne, by="dpt")
View(base68)
write_xlsx(base68,"base68.xlsx")
write_xlsx(base75,"base75.xlsx")
write_xlsx(base82,"base82.xlsx")
write_xlsx(base90,"base90.xlsx")
write_xlsx(base99,"base99.xlsx")
write_xlsx(base06,"base06.xlsx")
write_xlsx(paires,"paires.xlsx")
View(paires)
View(paires)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(tidyverse)
library("writexl")
library(foreign)
library(DAAG)
library(tidyr)
library(lfe)
library(stargazer)
library(miceadds)
install.packages("miceadds")
library(miceadds)
base68 <- read_excel("base68.xlsx")
base75 <- read_excel("base75.xlsx")
base82 <- read_excel("base82.xlsx")
base90 <- read_excel("base90.xlsx")
base99 <- read_excel("base99.xlsx")
base06 <- read_excel("base06.xlsx")
base68 <- read_excel("base68.xlsx")
base75 <- read_excel("base75.xlsx")
base82 <- read_excel("base82.xlsx")
base90 <- read_excel("base90.xlsx")
base99 <- read_excel("base99.xlsx")
base06 <- read_excel("base06.xlsx")
base68 <- base68 %>%
mutate(y1968=1,
y1975=0,
y1982=0,
y1990=0,
y1999=0,
y2006=0)
base75 <- base75 %>%
mutate(y1968=0,
y1975=1,
y1982=0,
y1990=0,
y1999=0,
y2006=0)
base82 <- base82 %>%
mutate(y1968=0,
y1975=0,
y1982=1,
y1990=0,
y1999=0,
y2006=0)
base90 <- base90 %>%
mutate(y1968=0,
y1975=0,
y1982=0,
y1990=1,
y1999=0,
y2006=0)
base99 <- base99 %>%
mutate(y1968=0,
y1975=0,
y1982=0,
y1990=0,
y1999=1,
y2006=0)
base06 <- base06 %>%
mutate(y1968=0,
y1975=0,
y1982=0,
y1990=0,
y1999=0,
y2006=1)
base_dum <- rbind(base68, base75, base82, base90, base99, base06) %>%
filter(dpt<=95) %>%
filter(dpt!=20) %>%
mutate(dpt=as.factor(dpt)) %>%
mutate(annee = ifelse(y1968==1, 1968,ifelse(y1975==1,1975,ifelse(y1982==1,1982,ifelse(y1990==1,1990,ifelse(y1999==1,1999,2006)))))) %>%
mutate(annee=as.factor(annee))
base_dum <- base_dum %>%
mutate(prop_inanc = prop_ina+prop_anc)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(tidyverse)
library("writexl")
library(foreign)
library(DAAG)
library(tidyr)
library(lfe)
library(stargazer)
library(miceadds)
#wd <- "C:/Users/Cécile/Documents/3A/Projet/"
#setwd(wd)
base68 <- read_excel("base68.xlsx")
base68 <- read_excel("base68.xlsx")
library(dplyr)
library(readxl)
library(tidyverse)
library("writexl")
library(foreign)
library(DAAG)
library(tidyr)
library(lfe)
library(stargazer)
library(miceadds)
base68 <- read_excel("base68.xlsx")
base75 <- read_excel("base75.xlsx")
base82 <- read_excel("base82.xlsx")
base90 <- read_excel("base90.xlsx")
base99 <- read_excel("base99.xlsx")
base06 <- read_excel("base06.xlsx")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(tidyverse)
library("writexl")
library(foreign)
library(DAAG)
library(tidyr)
library(lfe)
library(stargazer)
library(miceadds)
base68 <- read_excel("base68.xlsx")
base75 <- read_excel("base75.xlsx")
base82 <- read_excel("base82.xlsx")
base90 <- read_excel("base90.xlsx")
base99 <- read_excel("base99.xlsx")
base06 <- read_excel("base06.xlsx")
base68 <- base68 %>%
mutate(y1968=1,
y1975=0,
y1982=0,
y1990=0,
y1999=0,
y2006=0)
base75 <- base75 %>%
mutate(y1968=0,
y1975=1,
y1982=0,
y1990=0,
y1999=0,
y2006=0)
base82 <- base82 %>%
mutate(y1968=0,
y1975=0,
y1982=1,
y1990=0,
y1999=0,
y2006=0)
base90 <- base90 %>%
mutate(y1968=0,
y1975=0,
y1982=0,
y1990=1,
y1999=0,
y2006=0)
base99 <- base99 %>%
mutate(y1968=0,
y1975=0,
y1982=0,
y1990=0,
y1999=1,
y2006=0)
base06 <- base06 %>%
mutate(y1968=0,
y1975=0,
y1982=0,
y1990=0,
y1999=0,
y2006=1)
base_dum <- rbind(base68, base75, base82, base90, base99, base06) %>%
filter(dpt<=95) %>%
filter(dpt!=20) %>%
mutate(dpt=as.factor(dpt)) %>%
mutate(annee = ifelse(y1968==1, 1968,ifelse(y1975==1,1975,ifelse(y1982==1,1982,ifelse(y1990==1,1990,ifelse(y1999==1,1999,2006)))))) %>%
mutate(annee=as.factor(annee))
base_dum <- base_dum %>%
mutate(prop_inanc = prop_ina+prop_anc)
reg_fe_cl <- lm.cluster(freq ~ part_bret + reg_bret + age_moy + avg_cont + prop_agr + prop_art + prop_cad + prop_emp + prop_ouv + prop_anc + prop_ina + annee + annee:part_bret + annee:reg_bret + annee:age_moy + annee:avg_cont + dpt , cluster='dpt',data=base_dum)
summary(reg_fe_cl)
#Automatisation du modèle avec distance
create_paires <- function(base){
new <- paires %>%
left_join(base, by = c("dpt1" = "dpt")) %>%
select(-c("avg_cont","bret_cont","age_cont","agr_cont","art_cont","cad_cont","pi_cont","emp_cont","ouv_cont","anc_cont","ina_cont","nb_vois")) %>%
left_join(base, by = c("dpt2" = "dpt")) %>%
select(-c("avg_cont","bret_cont","age_cont","agr_cont","art_cont","cad_cont","pi_cont","emp_cont","ouv_cont","anc_cont","ina_cont","nb_vois")) %>%
select(-c("voisins.x.x","voisins.y.y")) %>%
mutate(MD_prenoms=2*abs(freq.x-freq.y)) %>%
mutate(MD_bretons=2*abs(part_bret.x-part_bret.y)) %>%
mutate(MD_pcs=abs(prop_agr.x-prop_agr.y)+abs(prop_art.x-prop_art.y)+abs(prop_cad.x-prop_cad.y)+abs(prop_pi.x-prop_pi.y)+abs(prop_emp.x-prop_emp.y)+abs(prop_ouv.x-prop_ouv.y)+abs(prop_anc.x-prop_anc.y)+abs(prop_ina.x-prop_ina.y))
return(new)
}
modeleDIST_TFE <- function(base_paires){
estim <- plm(MD_prenoms ~ MD_bretons + MD_pcs + ind_voisins + distance_géo, data=base_paires,index = c("dpt1","dpt2","annee"), model = "within")
print(summary(estim))
return(stargazer(estim,type="latex",column.sep.width = "5pt",font.size = "small"))
}
base_dum <- base_dum %>%
mutate(dpt=as.numeric(dpt))
dum_paire <- create_paires(base_dum) %>%
filter(annee.x==annee.y)
base_dum <- base_dum %>%
mutate(dpt=as.numeric(dpt))
dum_paire <- create_paires(base_dum) %>%
filter(annee.x==annee.y)
paires <- read_excel("paires.xlsx")
#Automatisation du modèle avec distance
create_paires <- function(base){
new <- paires %>%
left_join(base, by = c("dpt1" = "dpt")) %>%
select(-c("avg_cont","bret_cont","age_cont","agr_cont","art_cont","cad_cont","pi_cont","emp_cont","ouv_cont","anc_cont","ina_cont","nb_vois")) %>%
left_join(base, by = c("dpt2" = "dpt")) %>%
select(-c("avg_cont","bret_cont","age_cont","agr_cont","art_cont","cad_cont","pi_cont","emp_cont","ouv_cont","anc_cont","ina_cont","nb_vois")) %>%
select(-c("voisins.x.x","voisins.y.y")) %>%
mutate(MD_prenoms=2*abs(freq.x-freq.y)) %>%
mutate(MD_bretons=2*abs(part_bret.x-part_bret.y)) %>%
mutate(MD_pcs=abs(prop_agr.x-prop_agr.y)+abs(prop_art.x-prop_art.y)+abs(prop_cad.x-prop_cad.y)+abs(prop_pi.x-prop_pi.y)+abs(prop_emp.x-prop_emp.y)+abs(prop_ouv.x-prop_ouv.y)+abs(prop_anc.x-prop_anc.y)+abs(prop_ina.x-prop_ina.y))
return(new)
}
modeleDIST_TFE <- function(base_paires){
estim <- plm(MD_prenoms ~ MD_bretons + MD_pcs + ind_voisins + distance_géo, data=base_paires,index = c("dpt1","dpt2","annee"), model = "within")
print(summary(estim))
return(stargazer(estim,type="latex",column.sep.width = "5pt",font.size = "small"))
}
base_dum <- base_dum %>%
mutate(dpt=as.numeric(dpt))
dum_paire <- create_paires(base_dum) %>%
filter(annee.x==annee.y)
est_md <- felm(MD_prenoms ~ MD_bretons + MD_pcs + ind_voisins + distance_géo + annee.x:MD_bretons + annee.x:MD_pcs + annee.x:ind_voisins + annee.x:distance_géo |dpt1+dpt2+annee.x,data=dum_paire)
summary(est_md)
stargazer(est_md,type="latex",column.sep.width = "5pt",font.size = "small",single.row=TRUE)
base_dum_nobret <- base_dum_nobret %>%
mutate(dpt=as.numeric(dpt))
```{r}
base_dum_nobret <- base_dum %>% filter(reg_bret==0)
base_dum_nobret <- base_dum_nobret %>%
mutate(dpt=as.numeric(dpt))
dum_paire_nobret <- create_paires(base_dum_nobret) %>%
filter(annee.x==annee.y)
est_md_nobret <- felm(MD_prenoms ~ MD_bretons + MD_pcs + ind_voisins + distance_géo + annee.x:MD_bretons + annee.x:MD_pcs + annee.x:ind_voisins + annee.x:distance_géo |dpt1+dpt2+annee.x,data=dum_paire_nobret)
summary(est_md_nobret)
stargazer(est_md,est_md_nobret,type="latex",column.sep.width = "5pt",font.size = "small",single.row=TRUE)
library(spdep)
library(dplyr)
library(readxl)
library(igraph)
library(reshape2)
contiguite <- read_xlsx("contiguous_cols.xlsx") %>%
filter(dpt!="20")
contiguite_nobret <- read_xlsx("contiguous_cols_nobret.xlsx") %>%
filter(dpt!="20")
bretons <- read_xlsx("prop_bretons_annee_dep.xlsx") %>%
mutate(dep_res=as.numeric(dep_res)) %>%
filter(dep_res <= 95) %>%
filter(!(is.na(dep_res)))
bretons <- read_xlsx("prop_bretons_annee_dep_new.xlsx") %>%
mutate(dep_res=as.numeric(dep_res)) %>%
filter(dep_res <= 95) %>%
filter(!(is.na(dep_res)))
contiguite <- read_xlsx("contiguous_cols.xlsx") %>%
filter(dpt!="20")
contiguite_nobret <- read_xlsx("contiguous_cols_nobret.xlsx") %>%
filter(dpt!="20")
bretons <- read_xlsx("prop_bretons_annee_dep_new.xlsx") %>%
mutate(dep_res=as.numeric(dep_res)) %>%
filter(dep_res <= 95) %>%
filter(!(is.na(dep_res)))
colnames(bretons) <- c("dpt","p68","p75","82","p90","p99","p06")
prenoms_bretons_68 <- read_xlsx("base68.xlsx") %>%
select(dpt,freq) %>%
rename(prenbret=freq) %>%
filter(dpt<=95) %>%
filter(dpt!=20)
prenoms_bretons_06 <- read_xlsx("base06.xlsx") %>%
select(dpt,freq) %>%
rename(prenbret=freq) %>%
filter(dpt<=95) %>%
filter(dpt!=20)
df_voisins <- melt(contiguite,id.vars = "dpt") %>%
filter(!(is.na(value))) %>%
select(-variable) %>%
filter(value!=20,dpt!=20)
adja <- get.adjacency(graph.edgelist(as.matrix(df_voisins), directed=FALSE))
adja <- as.matrix(adja)
adja <- adja[-20,-20]
adja <- adja/2
rownames(adja) <- prenoms_bretons_68$dpt
my_listw <- mat2listw(adja,  style="M")
moran.plot(prenoms_bretons_68$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (1968, France métropolitaine hors Corse)")
moran.test(prenoms_bretons_68$prenbret,my_listw)
moran.plot(prenoms_bretons_06$prenbret,my_listw,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (2006, France métropolitaine hors Corse)")
moran.test(prenoms_bretons_06$prenbret,my_listw)
prenbret68_nobret <- prenoms_bretons_68 %>% filter(!(dpt %in% c(22,29,35,56)))
prenbret06_nobret <- prenoms_bretons_06 %>% filter(!(dpt %in% c(22,29,35,56)))
df_voisins_nobret <- melt(contiguite_nobret,id.vars = "dpt") %>%
filter(!(is.na(value))) %>%
select(-variable) %>%
filter(value!=20,dpt!=20)
adja_nobret <- get.adjacency(graph.edgelist(as.matrix(df_voisins_nobret), directed=FALSE))
adja_nobret <- as.matrix(adja_nobret)
adja_nobret <- adja_nobret[-c(20,22,29,35,56),-c(20,22,29,35,56)]
adja_nobret <- adja_nobret/2
rownames(adja_nobret) <- prenbret68_nobret$dpt
my_listw_nobret <- mat2listw(adja_nobret,  style="M")
moran.plot(prenbret68_nobret$prenbret,my_listw_nobret,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (1968, France métropolitaine hors Corse et hors Bretagne)")
moran.test(prenbret68_nobret$prenbret,my_listw_nobret)
moran.plot(prenbret06_nobret$prenbret,my_listw_nobret,xlab="Part de prénoms bretons",ylab="Moyenne de la part de prénoms bretons dans les départements voisins",main="Diagramme de Moran de la part de prénoms bretons \n (2006, France métropolitaine hors Corse et hors Bretagne)")
moran.test(prenbret06_nobret$prenbret,my_listw_nobret,alternative="greater")
summary(base_dum)
base_dum
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(tidyverse)
library("writexl")
library(foreign)
library(DAAG)
library(tidyr)
library(lfe)
library(stargazer)
library(miceadds)
base68 <- read_excel("base68.xlsx")
base75 <- read_excel("base75.xlsx")
base82 <- read_excel("base82.xlsx")
base90 <- read_excel("base90.xlsx")
base99 <- read_excel("base99.xlsx")
base06 <- read_excel("base06.xlsx")
base68 <- base68 %>%
mutate(y1968=1,
y1975=0,
y1982=0,
y1990=0,
y1999=0,
y2006=0)
base75 <- base75 %>%
mutate(y1968=0,
y1975=1,
y1982=0,
y1990=0,
y1999=0,
y2006=0)
base82 <- base82 %>%
mutate(y1968=0,
y1975=0,
y1982=1,
y1990=0,
y1999=0,
y2006=0)
base90 <- base90 %>%
mutate(y1968=0,
y1975=0,
y1982=0,
y1990=1,
y1999=0,
y2006=0)
base99 <- base99 %>%
mutate(y1968=0,
y1975=0,
y1982=0,
y1990=0,
y1999=1,
y2006=0)
base06 <- base06 %>%
mutate(y1968=0,
y1975=0,
y1982=0,
y1990=0,
y1999=0,
y2006=1)
base_dum <- rbind(base68, base75, base82, base90, base99, base06) %>%
filter(dpt<=95) %>%
filter(dpt!=20) %>%
mutate(dpt=as.factor(dpt)) %>%
mutate(annee = ifelse(y1968==1, 1968,ifelse(y1975==1,1975,ifelse(y1982==1,1982,ifelse(y1990==1,1990,ifelse(y1999==1,1999,2006)))))) %>%
mutate(annee=as.factor(annee))
base_dum <- base_dum %>%
mutate(prop_inanc = prop_ina+prop_anc)
reg_fe_cl <- lm.cluster(freq ~ part_bret + reg_bret + age_moy + avg_cont + prop_agr + prop_art + prop_cad + prop_emp + prop_ouv + prop_anc + prop_ina + annee + annee:part_bret + annee:reg_bret + annee:age_moy + annee:avg_cont + dpt , cluster='dpt',data=base_dum)
summary(reg_fe_cl)
base_dum
class(base_dum)
summary(base_dum)
class(base_dum$dpt)
